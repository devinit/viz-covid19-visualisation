(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{314:function(t,e,n){var content=n(326);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(53).default)("24b51ecc",content,!0,{sourceMap:!1})},325:function(t,e,n){"use strict";n(314)},326:function(t,e,n){var r=n(52)(!1);r.push([t.i,".bar-chart[data-v-52760b70]{height:300px}",""]),t.exports=r},327:function(t,e,n){"use strict";n(10),n(8);var r={name:"SummaryBarChart",components:{BarChart:{extends:n(366).a,props:["data","options"],mounted:function(){this.renderChart(this.data,this.options)},watch:{data:function(){this.renderChart(this.data,this.options)}}}},props:["barChartData","labelField","valueField","valueLabel","valuePrecision","step"],data:function(){return{}},computed:{barChartOptions:function(){var t=this;return{maintainAspectRatio:!1,legend:{display:!1},tooltips:{callbacks:{title:function(e,data){return t.chartData.labels[e[0].index]},label:function(e,data){var label=t.valueLabel||"";return label&&(label+=": "),t.valuePrecision?label+=e.yLabel.toLocaleString(void 0,{maximumFractionDigits:t.valuePrecision,minimumFractionDigits:t.valuePrecision}):label+=e.yLabel,label}}},scales:{yAxes:[{ticks:{beginAtZero:!0,precision:this.valuePrecision,stepSize:this.step?this.step:void 0,callback:function(t){return t.toLocaleString(void 0,{maximumFractionDigits:this.valuePrecision,minimumFractionDigits:this.valuePrecision})}},scaleLabel:{display:!0,labelString:this.valueLabel}}],xAxes:[{ticks:{callback:function(t){return t.length>=20?t.slice(0,t.length).substring(0,19).trim()+"...":t}}}]}}},chartData:function(){var t=this;return{datasets:[{label:this.labelField,fill:!0,data:this.barChartData.map((function(e){return e[t.valueField]})).slice(0,20),backgroundColor:["#6e40aa","#6849b9","#6153c7","#585fd2","#4e6cda","#4479df","#3988e1","#2f96e0","#26a5db","#1fb3d3","#1bc1c8","#19cdbb","#1bd9ac","#20e29d","#28ea8d","#34f07e","#44f470","#56f665","#6bf75c","#81f558","#98f357","#aff05b"]}],labels:this.barChartData.map((function(e){return e[t.labelField]})).slice(0,20)}}}},o=(n(325),n(51)),component=Object(o.a)(r,(function(){var t=this,e=t._self._c;return e("div",[t.barChartData.length>0?[t.barChartData?e("BarChart",{staticClass:"bar-chart",attrs:{data:t.chartData,options:t.barChartOptions}}):t._e(),t._v(" "),t.barChartData.length>20?e("p",{staticClass:"text-muted mb-3 mt-3"},[t._v("\n      Showing the top 20 entries. Change view to "),e("b",[t._v("Table")]),t._v(" to view all\n      entries.\n    ")]):t._e()]:[e("div",{staticClass:"bar-chart"},[e("b-alert",{staticClass:"text-center",attrs:{show:"",variant:"secondary"}},[t._v("\n        No data to display. Try adjusting the filters.\n      ")])],1)]],2)}),[],!1,null,"52760b70",null);e.a=component.exports},358:function(t,e,n){var content=n(395);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(53).default)("ddae5092",content,!0,{sourceMap:!1})},394:function(t,e,n){"use strict";n(358)},395:function(t,e,n){var r=n(52)(!1);r.push([t.i,".filter-text b,.selection-text b{border-bottom:2px solid #eee;cursor:pointer}.is-valid .vs__dropdown-toggle{border-color:#28a745}",""]),t.exports=r},409:function(t,e,n){"use strict";n.r(e);var r=n(21),o=(n(61),n(94),n(75),n(1),n(313),n(17),n(13),n(8),n(71)),l=n.n(o),c=n(392),m=n.n(c),d=n(121),v={components:{BarChart:n(327).a},props:["activityData","displaySummary","summaryLabelField","codelists","getCountryName","getSectorName","summaryType","activityTransactionsData"],data:function(){return{}},computed:{valueField:function(){return this.summaryType},valueLabel:function(){return{number_of_projects:"Number of projects",commitments:"Commitments (USD)",disbursements:"Disbursements (USD)"}[this.summaryType]},summaryData:function(){return"number_of_projects"===this.summaryType?this.summaryActivityData:this.summaryActivityTransactionsData},summaryActivityData:function(){var t=this;return Object.values(this.activityData.reduce((function(summary,e){var n=function(t){return t.reportingOrg.text},r=function(e){return t.getCountryName(e)},o=function(e){return t.getSectorName(e)};if("organisation"===t.summaryLabelField){var l=summary[n(e)]?summary[n(e)]:summary[n(e)]={organisation:n(e)};l[t.valueField]?l[t.valueField]+=1:l[t.valueField]=1}else if("country"===t.summaryLabelField){(e.countriesRegions.length>0?e.countriesRegions:[{code:""}]).forEach((function(e){var n=summary[r(e)]?summary[r(e)]:summary[r(e)]={country:r(e)};n[t.valueField]?n[t.valueField]+=1:n[t.valueField]=1}))}else if("sector"===t.summaryLabelField){(e.sectors.length>0?e.sectors:[{code:""}]).forEach((function(e){var n=summary[o(e)]?summary[o(e)]:summary[o(e)]={sector:o(e)};n[t.valueField]?n[t.valueField]+=1:n[t.valueField]=1}))}return summary}),{})).sort((function(a,b){return a[t.valueField]>b[t.valueField]?1:-1})).reverse()},summaryActivityTransactionsData:function(){var t=this,e=function(t){return t.reporting_org_text},n=function(e){return""===e.country_region?"Unspecified":t.getCountryName({code:e.country_region})},r=function(e){return""===e.sector?"Unspecified":t.getSectorName({code:e.sector})};return Object.values(this.activityTransactionsData.reduce((function(summary,o){if("organisation"===t.summaryLabelField)var l=summary[e(o)]?summary[e(o)]:summary[e(o)]={organisation:e(o),commitments:0,disbursements:0};else if("country"===t.summaryLabelField)l=summary[n(o)]?summary[n(o)]:summary[n(o)]={country:n(o),commitments:0,disbursements:0};else if("sector"===t.summaryLabelField)l=summary[r(o)]?summary[r(o)]:summary[r(o)]={sector:r(o),commitments:0,disbursements:0};return"2"===o.transaction_type_code?l.commitments+=o.value_USD_proportionate:"3"===o.transaction_type_code&&(l.disbursements+=o.value_USD_proportionate),summary}),{})).sort((function(a,b){return a[t.valueField]>b[t.valueField]?1:-1})).reverse()},summaryFields:function(){return[{key:this.summaryLabelField,sortable:!0},{key:this.valueField,sortable:!0,thClass:"text-right",tdClass:"text-right",formatter:"valueFormatter"}]}},methods:{valueFormatter:function(t){return t?Math.round(t):0}}},h=n(51),y=Object(h.a)(v,(function(){var t=this,e=t._self._c;return e("div",["chart"===t.displaySummary?e("BarChart",{attrs:{"bar-chart-data":t.summaryData,"label-field":t.summaryLabelField,"value-label":t.valueLabel,"value-field":t.valueField,"value-precision":"0"}}):t._e(),t._v(" "),"table"===t.displaySummary?e("b-table",{attrs:{items:t.summaryData,fields:t.summaryFields,"asort-by":"total_value","asort-desc":"true",small:"","head-variant":"dark",bordered:""}}):t._e()],1)}),[],!1,null,null,null).exports,f={components:{},props:["displaySummary","summaryLabelField","selectedCountry","countries","selectedReportingOrg","reportingOrgs","selectedSector","sectors","selectedHumanitarianDevelopment","summaryType","m49Codelists","activityUsedCodelists","selectedCOVIDMatches"],data:function(){return{summaryLabelOptions:[{value:"organisation",text:"Reporting organisation"},{value:"country",text:"Country"},{value:"sector",text:"Sector"}],summaryDisplayOptions:[{value:"chart",text:"Chart"},{value:"table",text:"Table"}],summaryTypeOptions:[{value:"number_of_projects",text:"Number of projects"},{value:"commitments",text:"Commitments"},{value:"disbursements",text:"Disbursements"}],humanitarianDevelopmentOptions:[{value:"humanitarian",text:"Humanitarian"},{value:"humanitarian / development",text:"Humanitarian / Development"},{value:"development",text:"Development"},{value:"unspecified",text:"Unspecified"}],selectedOrganisationType:null,organisationType:[{value:null,text:"Select one..."},{value:"10",text:"Government"},{value:"15",text:"Other Public Sector"},{value:"21",text:"International NGO"},{value:"22",text:"National NGO"},{value:"30",text:"Public Private Partnership"},{value:"40",text:"Multilateral"},{value:"60",text:"Foundation"},{value:"70",text:"Private Sector"},{value:"80",text:"Academic, Training and Research"},{value:"90",text:"Other"}],COVIDMatchesOptions:[{value:"title",text:"Activity Title"},{value:"description",text:"Activity Description"},{value:"GLIDE",text:"GLIDE Code"},{value:"HRP",text:"HRP Code"},{value:"tag",text:"Tag"},{value:"transaction-description",text:"Transaction Description"}]}},computed:{filterText:function(){var t=[];return this.country.length>0&&t.push({text:"in ",filter:this.countryText}),this.organisation.length>0&&t.push({text:"reported by ",filter:this.organisationText}),this.sector.length>0&&t.push({text:"in the sector ",filter:this.sectorText}),4!==this.humanitarianDevelopment.length&&t.push({text:"classified as ",filter:this.humanitarianDevelopment.join(", ")}),6!==this.COVIDMatches.length&&t.push({text:"matching IATI Publishing Guidance by ",filter:this.COVIDMatchesText.join(", ")}),0===t.length?null:t},countryText:function(){var t=this;return this.countries.filter((function(option){return t.country.includes(option.value)})).map((function(t){return t.text})).join(", ")},sectorText:function(){var t=this;return this.sectors.filter((function(option){return t.sector.includes(option.value)})).map((function(t){return t.text})).join(", ")},organisationText:function(){var t=this;return this.reportingOrgs.filter((function(option){return t.organisation.includes(option.value)})).map((function(t){return t.text})).join(", ")},summaryTypeText:function(){var t=this;return this.summaryTypeOptions.filter((function(option){return option.value===t.summaryType}))[0].text.toLowerCase()},summaryLabelText:function(){var t=this;return this.summaryLabelOptions.filter((function(option){return option.value===t.summaryLabelField}))[0].text.toLowerCase()},COVIDMatchesText:function(){var t=this;return this.COVIDMatchesOptions.filter((function(option){return t.COVIDMatches.includes(option.value)})).map((function(option){return option.text}))},COVIDMatches:{get:function(){return this.selectedCOVIDMatches},set:function(t){this.$emit("update:selectedCOVIDMatches",t)}},humanitarianDevelopment:{get:function(){return this.selectedHumanitarianDevelopment},set:function(t){this.$emit("update:selectedHumanitarianDevelopment",t)}},_summaryType:{get:function(){return this.summaryType},set:function(t){this.$emit("update:summaryType",t)}},summary:{get:function(){return this.displaySummary},set:function(t){this.$emit("update:displaySummary",t)}},summaryLabel:{get:function(){return this.summaryLabelField},set:function(t){this.$emit("update:summaryLabelField",t)}},organisation:{get:function(){return this.selectedReportingOrg},set:function(t){this.$emit("update:selectedReportingOrg",t)}},country:{get:function(){return this.selectedCountry},set:function(t){this.$emit("update:selectedCountry",t)}},sector:{get:function(){return this.selectedSector},set:function(t){this.$emit("update:selectedSector",t)}}},watch:{selectedOrganisationType:function(t){if(null!=t){var e=this.activityUsedCodelists.reportingOrgTypes[t].filter((function(t){return null!=t}));this.organisation=e||[]}}},methods:{selectCountries:function(t,e){var n=this;this.country=this.countries.filter((function(r){return!r.text.includes("regional")&&(null!=r.value&&n.m49Codelists[t].includes(r.value)===e)})).map((function(t){return t.value}))},resetFilters:function(){this.country=[],this.organisation=[],this.sector=[],this.selectedOrganisationType=null}}},_=(n(394),{components:{IATISummaryPaneControls:Object(h.a)(f,(function(){var t=this,e=t._self._c;return e("div",[e("b-row",[e("b-col",[e("h3",[t._v("Summary")]),t._v(" "),e("b-row",{staticClass:"mb-1"},[e("b-col",{attrs:{md:"8"}},[e("p",{staticClass:"lead selection-text"},[t._v("\n            Showing a "),e("b",{directives:[{name:"b-toggle",rawName:"v-b-toggle.controls-sidebar",modifiers:{"controls-sidebar":!0}}]},[t._v(t._s(t.displaySummary))]),t._v(" of\n            "),e("b",{directives:[{name:"b-toggle",rawName:"v-b-toggle.controls-sidebar",modifiers:{"controls-sidebar":!0}}]},[t._v(t._s(t.summaryTypeText))]),t._v(" by\n            "),e("b",{directives:[{name:"b-toggle",rawName:"v-b-toggle.controls-sidebar",modifiers:{"controls-sidebar":!0}}]},[t._v(t._s(t.summaryLabelText))]),t._v(".\n          ")])]),t._v(" "),e("b-col",{staticClass:"text-md-right",attrs:{md:"4"}},[e("b-btn",{directives:[{name:"b-toggle",rawName:"v-b-toggle.controls-sidebar",modifiers:{"controls-sidebar":!0}}],attrs:{variant:"success"}},[t._v("\n            Filter and customise display »\n          ")])],1)],1),t._v(" "),e("b-row",[e("b-col",[t.filterText?e("p",{staticClass:"filter-text"},[t._v("\n            Filtered to activities\n            "),t._l(t.filterText,(function(filter){return e("span",{key:filter.filter},[t._v("\n              "+t._s(filter.text)+" "),e("b",{directives:[{name:"b-toggle",rawName:"v-b-toggle.controls-sidebar",modifiers:{"controls-sidebar":!0}}]},[t._v(t._s(filter.filter))])])})),t._v(".\n          ")],2):t._e()])],1)],1)],1),t._v(" "),e("b-sidebar",{attrs:{id:"controls-sidebar",title:"Customise data","no-close-on-route-change":"",width:"500px",right:""}},[e("div",{staticClass:"px-3 py-2"},[e("h4",[t._v("Display as")]),t._v(" "),e("b-form-radio-group",{staticClass:"displaySummaryControls mb-1",staticStyle:{width:"100%"},attrs:{options:t.summaryDisplayOptions,buttons:"","button-variant":"outline-primary",size:"sm"},model:{value:t.summary,callback:function(e){t.summary=e},expression:"summary"}}),t._v(" "),e("hr"),t._v(" "),e("h4",[t._v("Summarise by")]),t._v(" "),e("b-form-radio-group",{staticClass:"displaySummaryControls mb-1",attrs:{options:t.summaryTypeOptions,size:"sm",stacked:""},model:{value:t._summaryType,callback:function(e){t._summaryType=e},expression:"_summaryType"}}),t._v(" "),e("hr"),t._v(" "),e("h4",[t._v("Breakdown by")]),t._v(" "),e("b-form-select",{staticClass:"displaySummaryControls mb-1",attrs:{options:t.summaryLabelOptions,size:"sm"},model:{value:t.summaryLabel,callback:function(e){t.summaryLabel=e},expression:"summaryLabel"}}),t._v(" "),e("hr"),t._v(" "),e("b-row",[e("b-col",[e("h4",[t._v("Filters")])]),t._v(" "),t.filterText?e("b-col",{staticClass:"text-right"},[e("b-btn",{attrs:{variant:"danger",size:"sm"},on:{click:t.resetFilters}},[t._v("\n            Reset\n          ")])],1):t._e()],1),t._v(" "),e("b-form-group",{attrs:{state:t.organisation.length>0||null,label:"Reporting Organisation"}},[e("v-select",{attrs:{options:t.reportingOrgs,"get-option-key":function(option){return option.value},"get-option-label":function(option){return option.text},reduce:function(option){return option.value},label:"text",placeholder:"All organisations",multiple:""},model:{value:t.organisation,callback:function(e){t.organisation=e},expression:"organisation"}})],1),t._v(" "),e("b-form-group",{attrs:{state:t.country.length>0||null,label:"Recipient Country"}},[e("v-select",{attrs:{options:t.countries,"get-option-key":function(option){return option.value},"get-option-label":function(option){return option.text},reduce:function(option){return option.value},label:"text",placeholder:"All countries",multiple:""},model:{value:t.country,callback:function(e){t.country=e},expression:"country"}})],1),t._v(" "),e("b-form-group",{attrs:{state:t.sector.length>0||null,label:"Sector"}},[e("v-select",{attrs:{options:t.sectors,"get-option-key":function(option){return option.value},"get-option-label":function(option){return option.text},reduce:function(option){return option.value},label:"text",placeholder:"All sectors",multiple:""},model:{value:t.sector,callback:function(e){t.sector=e},expression:"sector"}})],1),t._v(" "),e("b-form-group",{attrs:{label:"Humanitarian / Development"}},[e("b-form-checkbox-group",{attrs:{options:t.humanitarianDevelopmentOptions,size:"sm",stacked:"",switches:""},model:{value:t.humanitarianDevelopment,callback:function(e){t.humanitarianDevelopment=e},expression:"humanitarianDevelopment"}})],1),t._v(" "),e("b-form-group",{attrs:{label:"IATI COVID-19 Publishing Guidance",description:"Select activities based on which part(s) of the IATI COVID-19 Publishing Guidance they use."}},[e("b-form-checkbox-group",{attrs:{options:t.COVIDMatchesOptions,size:"sm",stacked:"",switches:""},model:{value:t.COVIDMatches,callback:function(e){t.COVIDMatches=e},expression:"COVIDMatches"}})],1),t._v(" "),e("hr"),t._v(" "),e("h5",[t._v("Select countries based on "),e("a",{attrs:{href:"https://unstats.un.org/unsd/methodology/m49/"}},[t._v("UN classifications")])]),t._v(" "),e("b-form-group",{staticClass:"mb-1",attrs:{label:"Least developed countries"}},[e("b-btn",{attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(e){return t.selectCountries("leastDeveloped",!0)}}},[t._v("\n          Include\n        ")]),t._v(" "),e("b-btn",{attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(e){return t.selectCountries("leastDeveloped",!1)}}},[t._v("\n          Exclude\n        ")])],1),t._v(" "),e("b-form-group",{staticClass:"mb-1",attrs:{label:"Land locked developing countries"}},[e("b-btn",{attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(e){return t.selectCountries("landLockedDeveloping",!0)}}},[t._v("\n          Include\n        ")]),t._v(" "),e("b-btn",{attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(e){return t.selectCountries("landLockedDeveloping",!1)}}},[t._v("\n          Exclude\n        ")])],1),t._v(" "),e("b-form-group",{staticClass:"mb-1",attrs:{label:"Small island developing states"}},[e("b-btn",{attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(e){return t.selectCountries("smallIslandDeveloping",!0)}}},[t._v("\n          Include\n        ")]),t._v(" "),e("b-btn",{attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(e){return t.selectCountries("smallIslandDeveloping",!1)}}},[t._v("\n          Exclude\n        ")])],1),t._v(" "),e("b-form-group",{attrs:{label:"Developed or developing"}},[e("b-btn",{attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(e){return t.selectCountries("developed",!0)}}},[t._v("\n          Developed\n        ")]),t._v(" "),e("b-btn",{attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(e){return t.selectCountries("developing",!0)}}},[t._v("\n          Developing\n        ")])],1),t._v(" "),e("h5",[t._v("Select reporting organisations based on type")]),t._v(" "),e("b-select",{staticClass:"mb-2",attrs:{options:t.organisationType},model:{value:t.selectedOrganisationType,callback:function(e){t.selectedOrganisationType=e},expression:"selectedOrganisationType"}})],1)])],1)}),[],!1,null,null,null).exports,IATISummaryPane:y},data:function(){return{title:d.a.head.title,displaySummary:"chart",summaryType:"number_of_projects",summaryLabelField:"organisation",summaryLabelFields:[{value:"organisation",text:"Reporting organisation"},{value:"country",text:"Country"}],transactionType:"2",transactionTypes:{2:"Commitments",3:"Disbursements",4:"Expenditure"},selectedCountry:[],selectedReportingOrg:[],selectedSector:[],selectedHumanitarianDevelopment:["humanitarian","humanitarian / development","development","unspecified"],downloadURLs:[{format:"Excel (activities)",url:"https://devinit.github.io/iati-covid19-first-prototype/xlsx/activities.xlsx"},{format:"Excel (transactions)",url:"https://devinit.github.io/iati-covid19-first-prototype/traceability/transactions.xlsx"},{format:"Excel (transactions - by country and sector)",url:"https://devinit.github.io/iati-covid19-first-prototype/traceability/transactions_sectors_countries_regions.xlsx"},{format:"JSON",url:"https://devinit.github.io/iati-covid19-first-prototype/activities.json"},{format:"XML",url:"https://devinit.github.io/iati-covid19-first-prototype/xml/activities.xml"}],currentPage:1,perPage:50,selectedCOVIDMatches:["title","description","GLIDE","HRP","tag","transaction-description"]}},computed:{displayDoubleCountingWarning:function(){return"organisation"!==this.summaryLabelField&&null===this.selectedReportingOrg},totalRows:function(){return this.activities.length},isBusy:function(){return 0===this.$store.state.originalActivityData.length},urls:function(){return{DATA_URL:"https://devinit.github.io/iati-covid19-first-prototype/activities.json",ACTIVITY_TRANSACTIONS_DATA_URL:"https://devinit.github.io/iati-covid19-first-prototype/traceability/transactions_sector_country.json",COUNTRIES_CODELIST_URL:"https://codelists.codeforiati.org/api/json/en/Country.json",REGIONS_CODELIST_URL:"https://codelists.codeforiati.org/api/json/en/Region.json",SECTORS_CODELIST_URL:"https://codelists.codeforiati.org/api/json/en/Sector.json",M49_CODELIST_URL:"https://devinit.github.io/iati-covid19-first-prototype/m49_countries_simplified.json"}},fields:function(){return[{key:"title",sortable:!0},{key:"reportingOrg",label:"Reported by",sortable:!0},{key:"implementingOrganisations",label:"Implemented by",sortable:!0},{key:"countriesRegions",label:"Country/Region",sortable:!0},{key:"totalAmountUSD",label:"Total Amount (USD)",sortable:!0,formatter:"numberFormatter"},{key:"commitmentsCOVID",label:"Covid-19-specific (USD)",sortable:!0,formatter:"numberFormatter"},{key:"humanitarianDevelopment",label:"Humanitarian?",sortable:!0}]},codelists:function(){return this.$store.state.codelists},tooltips:function(){return this.$store.state.tooltips},activityUsedCodelists:function(){return this.$store.state.activityUsedCodelists},m49Codelists:function(){return this.$store.state.m49Codelists},countries:function(){var t=this;return this.activityUsedCodelists.countriesRegions.reduce((function(summary,e){return summary.push({value:e,text:t.getCountryName({code:e})}),summary}),[]).sort((function(a,b){return a.text<b.text?-1:1}))},reportingOrgs:function(){var t=this;return this.activityUsedCodelists.reportingOrgs.reduce((function(summary,e){var n=t.activityUsedCodelists.reportingOrgNames[e];return summary.push({value:e,text:n}),summary}),[]).sort((function(a,b){return a.text<b.text?-1:1}))},sectors:function(){var t=this;return this.activityUsedCodelists.sectors.reduce((function(summary,e){return summary.push({value:e,text:t.getSectorName({code:e})}),summary}),[]).sort((function(a,b){return a.text<b.text?-1:1}))},originalActivityData:function(){return this.$store.state.originalActivityData},originalActivityTransactionData:function(){return this.$store.state.originalActivityTransactionData},activityTransactions:function(){var t=this;return 0===this.selectedCountry.length&&0===this.selectedReportingOrg.length&&0===this.selectedSector.length&&4===this.selectedHumanitarianDevelopment.length&&6===this.selectedCOVIDMatches.length?this.$store.state.originalActivityTransactionData:this.$store.state.originalActivityTransactionData.filter((function(e){return function(e){return 0===t.selectedReportingOrg.length||t.selectedReportingOrg.includes(e.reporting_org_ref)}(e)&&function(e){return 0===t.selectedCountry.length||t.selectedCountry.includes(e.country_region)}(e)&&function(e){return 4===t.selectedHumanitarianDevelopment.length||t.selectedHumanitarianDevelopment.includes({0:"development",1:"humanitarian",false:"development",true:"humanitarian",UNSPECIFIED:"unspecified"}[e.humanitarian])}(e)&&function(e){return 0===t.selectedSector.length||t.selectedSector.includes(e.sector)}(e)&&function(e){return 6===t.selectedCOVIDMatches.length||e.covid_matches.filter((function(e){return t.selectedCOVIDMatches.includes(e)})).length>0}(e)}))},activities:function(){var t=this;return 0===this.selectedCountry.length&&0===this.selectedReportingOrg.length&&0===this.selectedSector.length&&4===this.selectedHumanitarianDevelopment.length&&6===this.selectedCOVIDMatches.length?this.originalActivityData:this.originalActivityData.filter((function(e){return function(e){return 0===t.selectedReportingOrg.length||t.selectedReportingOrg.includes(e.reportingOrg.ref)}(e)&&function(e){return 0===t.selectedCountry.length||!(!t.selectedCountry.includes("")||0!==e.countriesRegions.length)||e.countriesRegions.filter((function(e){return t.selectedCountry.includes(e.code)})).length>0}(e)&&function(e){return 4===t.selectedHumanitarianDevelopment.length||t.selectedHumanitarianDevelopment.includes(e.humanitarianDevelopment)}(e)&&function(e){return 0===t.selectedSector.length||!(!t.selectedSector.includes("")||0!==e.sectors.length)||e.sectors.filter((function(e){return t.selectedSector.includes(e.code)})).length>0}(e)&&function(e){return 6===t.selectedCOVIDMatches.length||e.COVIDMatches.filter((function(e){return t.selectedCOVIDMatches.includes(e)})).length>0}(e)}))},urlQuery:function(){var t={};return this.selectedReportingOrg.length>0&&(t.organisation=Object.values(this.selectedReportingOrg).join()),this.selectedCountry.length>0&&(t.country=Object.values(this.selectedCountry).join()),this.selectedSector.length>0&&(t.sector=Object.values(this.selectedSector).join()),4!==this.selectedHumanitarianDevelopment.length&&(t.humanitarian=Object.values(this.selectedHumanitarianDevelopment).join()),"chart"!==this.displaySummary&&(t.display=this.displaySummary),"number_of_projects"!==this.summaryType&&(t.summary=this.summaryType),"organisation"!==this.summaryLabelField&&(t.breakdown=this.summaryLabelField),6!==this.selectedCOVIDMatches.length&&(t.covid_matches=Object.values(this.selectedCOVIDMatches).join()),t}},watch:{selectedCountry:function(t){t&&(this.summaryLabelField="organisation"),this.updateRouter()},selectedReportingOrg:function(t){t&&(this.summaryLabelField="country"),this.updateRouter()},selectedSector:function(t){this.updateRouter()},selectedHumanitarianDevelopment:function(t){this.updateRouter()},displaySummary:function(t){this.updateRouter()},displayType:function(t){this.updateRouter()},summaryLabelField:function(t){this.updateRouter()},summaryType:function(t){"number_of_projects"!==t&&0===this.originalActivityTransactionData.length&&this.loadActivityTransactionData(),this.updateRouter()},selectedCOVIDMatches:function(t){this.updateRouter()}},mounted:function(){var t=this;this.$nextTick((function(){"organisation"in t.$route.query&&(t.selectedReportingOrg=t.$route.query.organisation.split(",")),"country"in t.$route.query&&(t.selectedCountry=t.$route.query.country.split(",")),"sector"in t.$route.query&&(t.selectedSector=t.$route.query.sector.split(",")),"summary"in t.$route.query&&(t.summaryType=t.$route.query.summary),"breakdown"in t.$route.query&&(t.summaryLabelField=t.$route.query.breakdown),"display"in t.$route.query&&(t.displaySummary=t.$route.query.display),"humanitarian"in t.$route.query&&(t.selectedHumanitarianDevelopment=t.$route.query.humanitarian.split(",")),"covid_matches"in t.$route.query&&(t.selectedCOVIDMatches=t.$route.query.covid_matches.split(",")),0===Object.values(t.codelists.countries).length&&(t.$nuxt.$loading.start(),t.setup())}))},methods:{numberFormatter:function(t){return t?t.toLocaleString(void 0,{maximumFractionDigits:2,minimumFractionDigits:2}):""},getCountryName:function(t){return""===t.code?"Unspecified":this.codelists.countries[t.code]||"Unknown: ".concat(t.code)},getSectorName:function(t){var e=this.codelists.sectors[t.code];return e?"".concat(t.code,": ").concat(e):"".concat(t.code,": Unknown")},setup:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.get("".concat(t.urls.COUNTRIES_CODELIST_URL)).then((function(e){var data=e.data;t.$store.commit("setCodelistsCountry",data.data.reduce((function(t,e){return t[e.code]=e.name,t}),{}))}));case 2:return e.next=4,l.a.get("".concat(t.urls.REGIONS_CODELIST_URL)).then((function(e){var data=e.data;t.$store.commit("setCodelistsCountry",data.data.reduce((function(t,e){return t[e.code]=e.name,t}),t.$store.state.codelists.countries))}));case 4:return e.next=6,l.a.get("".concat(t.urls.SECTORS_CODELIST_URL)).then((function(e){var data=e.data;t.$store.commit("setCodelistsSector",data.data.reduce((function(t,e){return t[e.code]=e.name,t}),{}))}));case 6:return e.next=8,l.a.get("".concat(t.urls.M49_CODELIST_URL)).then((function(e){var data=e.data;t.$store.commit("setM49Codelists",data)}));case 8:t.loadData();case 9:case"end":return e.stop()}}),e)})))()},processActivityData:function(data){return data.map((function(t){return t.totalAmountUSD=t.commitmentsUSD?t.commitmentsUSD:t.budgetsUSD,t._cellVariants={commitmentsCOVID:t.COVIDComponent?"info":null},t}))},loadData:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.get("".concat(t.urls.DATA_URL));case 2:return n=e.sent,r=t.processActivityData(n.data.activities),t.$store.commit("setOriginalActivityData",r),t.$store.commit("setActivityUsedCodelists",n.data.codelists),e.next=8,l.a.get("/tooltips.csv").then((function(e){return m()().fromString(e.data).then((function(e){t.$store.commit("setTooltips",e)}))}));case 8:t.$nuxt.$loading.finish();case 9:case"end":return e.stop()}}),e)})))()},loadActivityTransactionData:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.get("".concat(t.urls.ACTIVITY_TRANSACTIONS_DATA_URL));case 2:data=e.sent,t.$store.commit("setOriginalActivityTransactionData",data.data),t.$nuxt.$loading.finish();case 5:case"end":return e.stop()}}),e)})))()},updateRouter:function(){this.$router.push({name:"activities",query:this.urlQuery})}}}),C=Object(h.a)(_,(function(){var t=this,e=t._self._c;return e("div",[e("b-alert",{attrs:{show:"",variant:"warning"}},[t._v("\n    This is a prototype visualisation to track the Covid-19 response. The data on this page comes from\n    "),e("a",{attrs:{href:"https://iatistandard.org"}},[t._v("IATI")]),t._v(". Read more on the\n    "),t._v(" "),e("nuxt-link",{attrs:{to:{name:"about"},"no-prefetch":""}},[t._v("about page")]),t._v(".\n  ")],1),t._v(" "),e("h2",[t._v("Activities")]),t._v(" "),e("hr"),t._v(" "),t.isBusy?[e("div",{staticClass:"text-center text-secondary"},[e("b-spinner",{staticClass:"align-middle"}),t._v(" "),e("strong",[t._v("Loading...")])],1)]:t._e(),t._v(" "),t.isBusy?t._e():[e("IATISummaryPaneControls",{attrs:{"display-summary":t.displaySummary,"summary-label-field":t.summaryLabelField,"selected-country":t.selectedCountry,countries:t.countries,"selected-reporting-org":t.selectedReportingOrg,"reporting-orgs":t.reportingOrgs,sectors:t.sectors,"selected-sector":t.selectedSector,"selected-humanitarian-development":t.selectedHumanitarianDevelopment,"summary-type":t.summaryType,"m49-codelists":t.m49Codelists,"activity-used-codelists":t.activityUsedCodelists,"selected-c-o-v-i-d-matches":t.selectedCOVIDMatches},on:{"update:displaySummary":function(e){t.displaySummary=e},"update:display-summary":function(e){t.displaySummary=e},"update:summaryLabelField":function(e){t.summaryLabelField=e},"update:summary-label-field":function(e){t.summaryLabelField=e},"update:selectedCountry":function(e){t.selectedCountry=e},"update:selected-country":function(e){t.selectedCountry=e},"update:selectedReportingOrg":function(e){t.selectedReportingOrg=e},"update:selected-reporting-org":function(e){t.selectedReportingOrg=e},"update:selectedSector":function(e){t.selectedSector=e},"update:selected-sector":function(e){t.selectedSector=e},"update:selectedHumanitarianDevelopment":function(e){t.selectedHumanitarianDevelopment=e},"update:selected-humanitarian-development":function(e){t.selectedHumanitarianDevelopment=e},"update:summaryType":function(e){t.summaryType=e},"update:summary-type":function(e){t.summaryType=e},"update:selectedCOVIDMatches":function(e){t.selectedCOVIDMatches=e},"update:selected-c-o-v-i-d-matches":function(e){t.selectedCOVIDMatches=e}}}),t._v(" "),t.activities?e("IATISummaryPane",{attrs:{"activity-data":t.activities,"activity-transactions-data":t.activityTransactions,"display-summary":t.displaySummary,"summary-label-field":t.summaryLabelField,codelists:t.codelists,"get-country-name":t.getCountryName,"get-sector-name":t.getSectorName,"summary-type":t.summaryType}}):t._e(),t._v(" "),e("b-alert",{staticClass:"text-muted mb-3 mt-3",attrs:{show:t.displayDoubleCountingWarning,variant:"warning"}},[t._v("\n      The above results may include double counting. "),e("a",{directives:[{name:"b-modal",rawName:"v-b-modal.double-counting-modal",modifiers:{"double-counting-modal":!0}}],attrs:{href:"#"}},[t._v("Read more")]),t._v(".\n    ")]),t._v(" "),e("b-modal",{attrs:{id:"double-counting-modal",title:"Double counting","ok-only":""}},[e("p",[t._v("\n        The visualisation may show double counting, if multiple organisations have published data\n        about the same flows at multiple points in the chain.\n      ")]),t._v(" "),e("p",[t._v("\n        For example, DFID could publish a contribution to a project managed by the World Health\n        Organisation. The WHO could in turn publish the project they are managing. At the moment,\n        the DFID contribution and the WHO's spend on this project would be added together; in reality\n        they should not be added together.\n      ")]),t._v(" "),e("p",[t._v("\n        We are developing methodologies to reduce the scope for this kind of double counting in\n        the visualisation.\n      ")])]),t._v(" "),e("hr"),t._v(" "),e("b-row",[e("b-col",{attrs:{sm:"7",md:"9"}},[e("h3",[t._v(t._s(t.activities.length)+" Activities")])]),t._v(" "),e("b-col",{staticClass:"text-sm-right",attrs:{sm:"5",md:"3"}},[e("b-dropdown",{staticClass:"mb-2",staticStyle:{width:"100%"},attrs:{text:"Download",right:"",variant:"primary"}},t._l(t.downloadURLs,(function(n){return e("b-dropdown-item",{key:n.format,attrs:{href:n.url,target:"_blank"}},[t._v("\n            "+t._s(n.format)+"\n          ")])})),1)],1)],1),t._v(" "),e("b-row",[e("b-col",{staticClass:"my-1",attrs:{sm:"5",md:"6"}},[e("b-form-group",{attrs:{label:"Activities per page","label-cols-sm":"7","label-cols-md":"7","label-cols-lg":"4","label-cols-xl":"3","label-align-sm":"right","label-size":"sm","label-for":"perPageSelect"}},[e("b-form-select",{attrs:{id:"perPageSelect",options:[50,100,500,1e3],size:"sm"},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)],1),t._v(" "),e("b-col",{staticClass:"my-1",attrs:{sm:"7",md:"6"}},[e("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage,align:"fill",size:"sm"},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1),t._v(" "),t.activities?e("b-table",{attrs:{items:t.activities,fields:t.fields,"current-page":t.currentPage,"per-page":t.perPage,sortable:"",responsive:""},scopedSlots:t._u([{key:"head()",fn:function(data){return[t._v("\n        "+t._s(data.label)+" "),e("b-badge",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{variant:"secondary",pill:"",title:t.tooltips[data.column]}},[t._v("\n          ?\n        ")])]}},{key:"cell(title)",fn:function(data){return[e("a",{attrs:{href:"http://d-portal.org/q.html?aid=".concat(data.item.iatiIdentifier),target:"_blank"}},[t._v(t._s(data.item.title))])]}},{key:"cell(reportingOrg)",fn:function(data){return[t._v("\n        "+t._s(data.item.reportingOrg.text)+"\n      ")]}},{key:"cell(implementingOrganisations)",fn:function(data){return t._l(data.item.participatingOrganisation[4],(function(n,r){return e("span",{key:"".concat(data.index,"-").concat(n.text,"-").concat(r)},[t._v("\n          "+t._s(n.text)+"\n        ")])}))}},{key:"cell(countriesRegions)",fn:function(data){return[data.item.countriesRegions.length>10?[e("span",[t._v("Multiple countries")])]:t._l(data.item.countriesRegions,(function(n){return e("span",{key:"".concat(data.index,"-").concat(n.code)},[t._v("\n            "+t._s(t.getCountryName(n))+"\n          ")])}))]}}],null,!1,1467225436)}):t._e(),t._v(" "),e("b-row",[e("b-col",{staticClass:"my-1",attrs:{sm:"5",md:"6"}},[e("b-form-group",{attrs:{label:"Activities per page","label-cols-sm":"7","label-cols-md":"7","label-cols-lg":"4","label-cols-xl":"3","label-align-sm":"right","label-size":"sm","label-for":"perPageSelect"}},[e("b-form-select",{attrs:{id:"perPageSelect",options:[50,100,500,1e3],size:"sm"},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)],1),t._v(" "),e("b-col",{staticClass:"my-1",attrs:{sm:"7",md:"6"}},[e("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage,align:"fill",size:"sm"},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)]],2)}),[],!1,null,null,null);e.default=C.exports}}]);